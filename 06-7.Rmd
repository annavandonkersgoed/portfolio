# Opdracht 7

Hier komt mijn relational databases te staan 

#Laad the fku data in drie verschillende dataframes in R 

#gapminder, Health and income outcomes for 184 countries from 1960 to 2016

install.packages("dslabs")
library(dslabs)
head(gapminder)

#download dengue_data.csv
library(tidyverse)
dengue_data <- read_csv(here::here("data", "dengue_data.csv"), skip = 11)


#dowload flu_data.csv
library(tidyverse)
flu_data <- read_csv(here::here("data", "flu_data.csv"), skip = 11)
head(flu_data)

#Check of de data tidy is, zo niet verander het naar tidy data
##De data is niet tidy. Er zijn veel na values aanwezig. Niet elke variabelen heeft een eigen kolom en niet elke observatie heeft een eigen rij. Je wilt het liefst onderscheiden per jaar, maand, dag, land etc 









#Verander de country en date variabelen van de drie data tabellen zodat ze met elkaar overeenkomen op data type, klasse en waarden. 

#Bewaar de 3 tabellen als .csv en .rds bestanden 

#Maak in Dbeaver een nieuwe PostgreSQL database genaamd workflowsdb

#voeg de tabellen in de database 

#inspecteer de inhoud van de databse met sql en bewaar het sql script 

#inspecteer de inhoud van de tabellen met dplyr in R 

#laad de gapminder data in R en verander de dataframe zodat dit samengevoegd kan worden met dengue en flu

#Voer joins uit met sql 

#maak een samengevoegde tabel en export dit van de database naar R

#Voer statistiek uit op de tabel 
